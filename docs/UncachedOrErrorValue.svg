<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="606px" preserveAspectRatio="none" style="width:1167px;height:606px;" version="1.1" viewBox="0 0 1167 606" width="1167px" zoomAndPan="magnify"><defs><filter height="300%" id="f1t8diy7877dfc" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="279" x="446.75" y="23.5352">Architecture Flow with uncached Value</text><rect fill="#D3D3D3" height="561.498" style="stroke: #A80036; stroke-width: 1.0;" width="655" x="14" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="70" x="306.5" y="47.0566">Local Data</text><rect fill="#ADD8E6" height="561.498" style="stroke: #A80036; stroke-width: 1.0;" width="156" x="691" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="86" x="726" y="47.0566">Remote Data</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="47" x2="47" y1="89.2871" y2="557.498"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="345.5" x2="345.5" y1="89.2871" y2="557.498"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="620" x2="620" y1="89.2871" y2="557.498"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="769" x2="769" y1="89.2871" y2="557.498"/><rect fill="#FEFECE" filter="url(#f1t8diy7877dfc)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="55" x="18" y="53.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="25" y="74.334">Query</text><rect fill="#FEFECE" filter="url(#f1t8diy7877dfc)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="55" x="18" y="556.498"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="25" y="577.0332">Query</text><rect fill="#FEFECE" filter="url(#f1t8diy7877dfc)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="315.5" y="53.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="322.5" y="74.334">Cache</text><rect fill="#FEFECE" filter="url(#f1t8diy7877dfc)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="315.5" y="556.498"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="322.5" y="577.0332">Cache</text><rect fill="#FEFECE" filter="url(#f1t8diy7877dfc)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="85" x="576" y="53.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="71" x="583" y="74.334">CacheMap</text><rect fill="#FEFECE" filter="url(#f1t8diy7877dfc)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="85" x="576" y="556.498"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="71" x="583" y="577.0332">CacheMap</text><rect fill="#FEFECE" filter="url(#f1t8diy7877dfc)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="144" x="695" y="53.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="130" x="702" y="74.334">RemoteDataSource</text><rect fill="#FEFECE" filter="url(#f1t8diy7877dfc)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="144" x="695" y="556.498"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="130" x="702" y="577.0332">RemoteDataSource</text><polygon fill="#A80036" points="333.5,116.5977,343.5,120.5977,333.5,124.5977,337.5,120.5977" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="47.5" x2="339.5" y1="120.5977" y2="120.5977"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="54.5" y="115.8555">getUser({ user: 3 })</text><polygon fill="#A80036" points="608.5,181.5293,618.5,185.5293,608.5,189.5293,612.5,185.5293" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="345.5" x2="614.5" y1="185.5293" y2="185.5293"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="352.5" y="180.7871">get CachedValue</text><path d="M625,133.5977 L625,219.5977 L1155,219.5977 L1155,143.5977 L1145,133.5977 L625,133.5977 " fill="#FBFB77" filter="url(#f1t8diy7877dfc)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1145,133.5977 L1145,143.5977 L1155,143.5977 L1145,133.5977 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="631" y="151.166">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="472" x="639" y="166.4766">[{ user: 1 }]: CacheValueResolved({ username: "Gigi", preferredColor: "red" }),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="501" x="639" y="181.7871">[{ user: 2 }]: CacheValueResolved({ username: "Sandro", preferredColor: "violet" })</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="639" y="197.0977">[{ user: 3 }]: CacheValueError || undefined</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="631" y="212.4082">}</text><polygon fill="#A80036" points="356.5,246.4609,346.5,250.4609,356.5,254.4609,352.5,250.4609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="350.5" x2="619.5" y1="250.4609" y2="250.4609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="225" x="362.5" y="245.7188">return CacheValueError || undefined</text><polygon fill="#A80036" points="608.5,311.3926,618.5,315.3926,608.5,319.3926,612.5,315.3926" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="345.5" x2="614.5" y1="315.3926" y2="315.3926"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="251" x="352.5" y="310.6504">set CachedValue for "{ user 3 }" to Initial</text><path d="M625,263.4609 L625,349.4609 L1155,349.4609 L1155,273.4609 L1145,263.4609 L625,263.4609 " fill="#FBFB77" filter="url(#f1t8diy7877dfc)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1145,263.4609 L1145,273.4609 L1155,273.4609 L1145,263.4609 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="631" y="281.0293">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="472" x="639" y="296.3398">[{ user: 1 }]: CacheValueResolved({ username: "Gigi", preferredColor: "red" }),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="501" x="639" y="311.6504">[{ user: 2 }]: CacheValueResolved({ username: "Sandro", preferredColor: "violet" })</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="183" x="639" y="326.9609">[{ user: 3 }]: CacheValueInitial</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="631" y="342.2715">}</text><polygon fill="#A80036" points="757,376.3242,767,380.3242,757,384.3242,761,380.3242" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="345.5" x2="763" y1="380.3242" y2="380.3242"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="352.5" y="375.582">get value for "{ user 3 }"</text><polygon fill="#A80036" points="356.5,405.6348,346.5,409.6348,356.5,413.6348,352.5,409.6348" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="350.5" x2="768" y1="409.6348" y2="409.6348"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="274" x="362.5" y="404.8926">{ username: "Mario", preferredColor: "blue" }</text><polygon fill="#A80036" points="608.5,470.5664,618.5,474.5664,608.5,478.5664,612.5,474.5664" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="345.5" x2="614.5" y1="474.5664" y2="474.5664"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="194" x="352.5" y="469.8242">set CachedValue for "{ user 3 }"</text><path d="M625,422.6348 L625,508.6348 L1155,508.6348 L1155,432.6348 L1145,422.6348 L625,422.6348 " fill="#FBFB77" filter="url(#f1t8diy7877dfc)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1145,422.6348 L1145,432.6348 L1155,432.6348 L1145,422.6348 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="631" y="440.2031">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="472" x="639" y="455.5137">[{ user: 1 }]: CacheValueResolved({ username: "Gigi", preferredColor: "red" }),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="501" x="639" y="470.8242">[{ user: 2 }]: CacheValueResolved({ username: "Sandro", preferredColor: "violet" })</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="485" x="639" y="486.1348">[{ user: 3 }]: CacheValueResolved({ username: "Mario", preferredColor: "blue" })</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="631" y="501.4453">}</text><polygon fill="#A80036" points="58.5,535.498,48.5,539.498,58.5,543.498,54.5,539.498" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="52.5" x2="344.5" y1="539.498" y2="539.498"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="274" x="64.5" y="534.7559">{ username: "Mario", preferredColor: "blue" }</text><!--
@startuml "UncachedOrErrorValue"
skinparam BoxPadding 10

title
Architecture Flow with uncached Value
end title

box "Local Data" #LightGray
participant Query
participant Cache
participant CacheMap
end box

box "Remote Data" #LightBlue
participant RemoteDataSource
end box

Query -> Cache : getUser({ user: 3 })
Cache -> CacheMap : get CachedValue
note right
{
  [{ user: 1 }]: CacheValueResolved({ username: "Gigi", preferredColor: "red" }),
  [{ user: 2 }]: CacheValueResolved({ username: "Sandro", preferredColor: "violet" })
  [{ user: 3 }]: CacheValueError || undefined
}
end note
CacheMap -> Cache : return CacheValueError || undefined
Cache -> CacheMap : set CachedValue for "{ user 3 }" to Initial
note right
{
  [{ user: 1 }]: CacheValueResolved({ username: "Gigi", preferredColor: "red" }),
  [{ user: 2 }]: CacheValueResolved({ username: "Sandro", preferredColor: "violet" })
  [{ user: 3 }]: CacheValueInitial
}
end note
Cache -> RemoteDataSource : get value for "{ user 3 }"
RemoteDataSource -> Cache : { username: "Mario", preferredColor: "blue" }
Cache -> CacheMap : set CachedValue for "{ user 3 }"
note right
{
  [{ user: 1 }]: CacheValueResolved({ username: "Gigi", preferredColor: "red" }),
  [{ user: 2 }]: CacheValueResolved({ username: "Sandro", preferredColor: "violet" })
  [{ user: 3 }]: CacheValueResolved({ username: "Mario", preferredColor: "blue" })
}
end note

Cache -> Query : { username: "Mario", preferredColor: "blue" }

@enduml

PlantUML version 1.2019.05(Sat Apr 20 18:45:36 CEST 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_181-b13
Operating System: Mac OS X
OS Version: 10.14.3
Default Encoding: UTF-8
Language: en
Country: IT
--></g></svg>
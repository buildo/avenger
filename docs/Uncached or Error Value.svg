<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="577px" preserveAspectRatio="none" style="width:1157px;height:577px;" version="1.1" viewBox="0 0 1157 577" width="1157px" zoomAndPan="magnify"><defs><filter height="300%" id="f1vvz39bh38g8o" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="279" x="441.75" y="23.5352">Architecture Flow with uncached Value</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="37" x2="37" y1="68.9766" y2="537.1875"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="335.5" x2="335.5" y1="68.9766" y2="537.1875"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="610" x2="610" y1="68.9766" y2="537.1875"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="739" x2="739" y1="68.9766" y2="537.1875"/><rect fill="#FEFECE" filter="url(#f1vvz39bh38g8o)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="55" x="8" y="33.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="15" y="54.0234">Query</text><rect fill="#FEFECE" filter="url(#f1vvz39bh38g8o)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="55" x="8" y="536.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="15" y="556.7227">Query</text><rect fill="#FEFECE" filter="url(#f1vvz39bh38g8o)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="305.5" y="33.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="312.5" y="54.0234">Cache</text><rect fill="#FEFECE" filter="url(#f1vvz39bh38g8o)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="305.5" y="536.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="312.5" y="556.7227">Cache</text><rect fill="#FEFECE" filter="url(#f1vvz39bh38g8o)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="85" x="566" y="33.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="71" x="573" y="54.0234">CacheMap</text><rect fill="#FEFECE" filter="url(#f1vvz39bh38g8o)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="85" x="566" y="536.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="71" x="573" y="556.7227">CacheMap</text><rect fill="#FEFECE" filter="url(#f1vvz39bh38g8o)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="144" x="665" y="33.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="130" x="672" y="54.0234">RemoteDataSource</text><rect fill="#FEFECE" filter="url(#f1vvz39bh38g8o)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="144" x="665" y="536.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="130" x="672" y="556.7227">RemoteDataSource</text><polygon fill="#A80036" points="323.5,96.2871,333.5,100.2871,323.5,104.2871,327.5,100.2871" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="37.5" x2="329.5" y1="100.2871" y2="100.2871"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="44.5" y="95.5449">getUser({ user: 3 })</text><polygon fill="#A80036" points="598.5,161.2188,608.5,165.2188,598.5,169.2188,602.5,165.2188" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="335.5" x2="604.5" y1="165.2188" y2="165.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="342.5" y="160.4766">get CachedValue</text><path d="M615,113.2871 L615,199.2871 L1145,199.2871 L1145,123.2871 L1135,113.2871 L615,113.2871 " fill="#FBFB77" filter="url(#f1vvz39bh38g8o)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1135,113.2871 L1135,123.2871 L1145,123.2871 L1135,113.2871 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="621" y="130.8555">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="472" x="629" y="146.166">[{ user: 1 }]: CacheValueResolved({ username: "Gigi", preferredColor: "red" }),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="501" x="629" y="161.4766">[{ user: 2 }]: CacheValueResolved({ username: "Sandro", preferredColor: "violet" })</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="629" y="176.7871">[{ user: 3 }]: CacheValueError || undefined</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="621" y="192.0977">}</text><polygon fill="#A80036" points="346.5,226.1504,336.5,230.1504,346.5,234.1504,342.5,230.1504" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="340.5" x2="609.5" y1="230.1504" y2="230.1504"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="225" x="352.5" y="225.4082">return CacheValueError || undefined</text><polygon fill="#A80036" points="598.5,291.082,608.5,295.082,598.5,299.082,602.5,295.082" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="335.5" x2="604.5" y1="295.082" y2="295.082"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="251" x="342.5" y="290.3398">set CachedValue for "{ user 3 }" to Initial</text><path d="M615,243.1504 L615,329.1504 L1145,329.1504 L1145,253.1504 L1135,243.1504 L615,243.1504 " fill="#FBFB77" filter="url(#f1vvz39bh38g8o)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1135,243.1504 L1135,253.1504 L1145,253.1504 L1135,243.1504 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="621" y="260.7188">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="472" x="629" y="276.0293">[{ user: 1 }]: CacheValueResolved({ username: "Gigi", preferredColor: "red" }),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="501" x="629" y="291.3398">[{ user: 2 }]: CacheValueResolved({ username: "Sandro", preferredColor: "violet" })</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="183" x="629" y="306.6504">[{ user: 3 }]: CacheValueInitial</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="621" y="321.9609">}</text><polygon fill="#A80036" points="727,356.0137,737,360.0137,727,364.0137,731,360.0137" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="335.5" x2="733" y1="360.0137" y2="360.0137"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="342.5" y="355.2715">get value for "{ user 3 }"</text><polygon fill="#A80036" points="346.5,385.3242,336.5,389.3242,346.5,393.3242,342.5,389.3242" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="340.5" x2="738" y1="389.3242" y2="389.3242"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="274" x="352.5" y="384.582">{ username: "Mario", preferredColor: "blue" }</text><polygon fill="#A80036" points="598.5,450.2559,608.5,454.2559,598.5,458.2559,602.5,454.2559" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="335.5" x2="604.5" y1="454.2559" y2="454.2559"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="194" x="342.5" y="449.5137">set CachedValue for "{ user 3 }"</text><path d="M615,402.3242 L615,488.3242 L1145,488.3242 L1145,412.3242 L1135,402.3242 L615,402.3242 " fill="#FBFB77" filter="url(#f1vvz39bh38g8o)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1135,402.3242 L1135,412.3242 L1145,412.3242 L1135,402.3242 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="621" y="419.8926">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="472" x="629" y="435.2031">[{ user: 1 }]: CacheValueResolved({ username: "Gigi", preferredColor: "red" }),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="501" x="629" y="450.5137">[{ user: 2 }]: CacheValueResolved({ username: "Sandro", preferredColor: "violet" })</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="485" x="629" y="465.8242">[{ user: 3 }]: CacheValueResolved({ username: "Mario", preferredColor: "blue" })</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="621" y="481.1348">}</text><polygon fill="#A80036" points="48.5,515.1875,38.5,519.1875,48.5,523.1875,44.5,519.1875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="42.5" x2="334.5" y1="519.1875" y2="519.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="274" x="54.5" y="514.4453">{ username: "Mario", preferredColor: "blue" }</text><!--
@startuml "Uncached or Error Value"

title
Architecture Flow with uncached Value
end title
participant Query
participant Cache
participant CacheMap
participant RemoteDataSource

Query -> Cache : getUser({ user: 3 })
Cache -> CacheMap : get CachedValue
note right
{
  [{ user: 1 }]: CacheValueResolved({ username: "Gigi", preferredColor: "red" }),
  [{ user: 2 }]: CacheValueResolved({ username: "Sandro", preferredColor: "violet" })
  [{ user: 3 }]: CacheValueError || undefined
}
end note
CacheMap -> Cache : return CacheValueError || undefined
Cache -> CacheMap : set CachedValue for "{ user 3 }" to Initial
note right
{
  [{ user: 1 }]: CacheValueResolved({ username: "Gigi", preferredColor: "red" }),
  [{ user: 2 }]: CacheValueResolved({ username: "Sandro", preferredColor: "violet" })
  [{ user: 3 }]: CacheValueInitial
}
end note
Cache -> RemoteDataSource : get value for "{ user 3 }"
RemoteDataSource -> Cache : { username: "Mario", preferredColor: "blue" }
Cache -> CacheMap : set CachedValue for "{ user 3 }"
note right
{
  [{ user: 1 }]: CacheValueResolved({ username: "Gigi", preferredColor: "red" }),
  [{ user: 2 }]: CacheValueResolved({ username: "Sandro", preferredColor: "violet" })
  [{ user: 3 }]: CacheValueResolved({ username: "Mario", preferredColor: "blue" })
}
end note

Cache -> Query : { username: "Mario", preferredColor: "blue" }

@enduml

PlantUML version 1.2019.05(Sat Apr 20 18:45:36 CEST 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_181-b13
Operating System: Mac OS X
OS Version: 10.14.3
Default Encoding: UTF-8
Language: en
Country: IT
--></g></svg>